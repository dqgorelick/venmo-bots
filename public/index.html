<!DOCTYPE html>
<html>

<head>
    <title>React Webpack Scaffold</title>
    <link rel="stylesheet" href="./dist/main.css">
    <script src='../javascripts/jquery.min.js'></script>
    <script src='../javascripts/dom-to-image.min.js'></script>
</head>

<body>
    <div class="dev">
      <button id="render">Render</button>
      <button id="upload">Send to server</button>
    </div>
    <div class="result-wrapper">
      <div class="result"></div>
    </div>
    <div id="app">
        <h2>React Webpack Scaffold</h2>
        <p>NOT WORKING</p>
    </div>
    <script src="./dist/bundle.js"></script>
    <script>
    (function() {
      var cats = 12;
      document.getElementById('render').addEventListener('click', function() {
          var node = document.querySelector('.comic-container');
          domtoimage.toPng(node)
              .then(function(dataUrl) {
                  var img = new Image();
                  img.src = dataUrl;
                  document.querySelector('.result').innerHTML = '';
                  document.querySelector('.result').appendChild(img);
              })
              .catch(function(error) {
                  console.error('oops, something went wrong!', error);
              });
      });
      // document.getElementById('upload').addEventListener('click', function() {
      //     $.post('http://localhost:9000/api/upload', { data: 'hello' }, function(data) {
      //       console.log('data',data);
      //     });
      // });
      document.getElementById('upload').addEventListener('click', function() {
        var image = document.querySelector('.result img');
        if (image) {
          var saveData = $.ajax({
            type: 'POST',
            url: 'http://localhost:9000/api/upload',
            data: JSON.stringify({data: 'hello'}),
            contentType: 'application/json',
            success: function(resultData) { alert("Save Complete") },
            error: function() { alert("Something went wrong")}
          });
        } else {
          alert('no image');
        }
      });
    })();
    </script>
</body>

</html>
